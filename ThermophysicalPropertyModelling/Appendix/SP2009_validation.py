import matplotlib.pyplot as plt
from SP2009 import SpycherPruss2009
import tikzplotlib

ydata = {
         20: {
                "P": [5.9908, 7.8341, 7.8341, 11.5207, 15.2074, 18.894, 24.424, 31.7972, 41.0138, 52.0737, 56.682, 57.6037, 59.447, 58.5253, 61.2903, 81.5668, 114.7465, 147.9263, 176.4977, 212.4424, 245.6221, 283.4101, 311.9816, 352.5346, 398.6175, 455.7604, 500.9217, 540.553, 588.4793],
                "y": [0.7985, 0.597, 0.3978, 0.297, 0.1985, 0.1604, 0.1269, 0.1022, 0.0821, 0.0776, 0.0799, 0.1201, 0.1649, 0.1985, 0.2433, 0.2612, 0.2769, 0.2836, 0.2881, 0.297, 0.306, 0.3127, 0.3149, 0.3172, 0.3194, 0.3239, 0.3284, 0.3284, 0.3306]
                },
         31: {
                "P": [7.9727, 7.9727, 8.8838, 9.795, 11.6173, 13.4396, 18.9066, 23.4624, 29.8405, 35.3075, 41.6856, 49.8861, 58.9977, 64.4647, 69.9317, 71.754, 73.5763, 73.5763, 75.3986, 76.3098, 89.0661, 100, 120.9567, 146.4692, 174.7153, 195.672, 242.1412, 281.3212, 326.8793, 374.2597, 428.9294, 486.3326, 557.4032],
                "y": [0.7816, 0.7, 0.6206, 0.5456, 0.4706, 0.4022, 0.3118, 0.2632, 0.1993, 0.1728, 0.1574, 0.1441, 0.1397, 0.1375, 0.1441, 0.1529, 0.1926, 0.2368, 0.2765, 0.314, 0.3449, 0.3603, 0.3846, 0.4, 0.4199, 0.4265, 0.4441, 0.4529, 0.4618, 0.4662, 0.475, 0.4772, 0.4816]},
         # 40: {
         #        "P": [4.3788, 5.5096, 7.6218, 9.708, 12.7106, 16.5971, 21.3739, 30.6481, 44.2442, 57.8079, 68.5704, 77.5001, 80.9901, 84.4282, 86.1049, 94.0273, 105.5697, 133.2299, 160.9355, 206.5787, 256.7388, 323.0426, 400.1479, 487.1058, 618.9335],
         #        "y": [0.9826, 0.9043, 0.7978, 0.6999, 0.5956, 0.4955, 0.3977, 0.2955, 0.2476, 0.2105, 0.2105, 0.2235, 0.2561, 0.306, 0.3452, 0.3951, 0.4342, 0.4819, 0.5143, 0.5467, 0.5682, 0.5895, 0.5978, 0.6104, 0.614]},
         60: {
                "P": [20.7373, 22.5806, 22.5806, 27.1889, 28.1106, 30.8756, 34.5622, 36.4055, 40.0922, 44.7005, 52.0737, 59.447, 66.8203, 71.4286, 79.7235, 87.0968, 94.47, 99.0783, 105.53, 111.0599, 118.4332, 127.6498,135.023, 147.0046, 158.9862, 176.4977, 199.5392, 223.5023, 255.7604, 284.3318, 315.6682, 356.2212, 429.9539, 474.1935, 525.8065, 570.0461],
                "y": [1.178, 1.1152, 1.0437, 0.9679, 0.8964, 0.8271, 0.7708, 0.7101, 0.669, 0.6191, 0.5693, 0.526, 0.5065, 0.4892, 0.4848, 0.4848, 0.4935, 0.5065, 0.5282, 0.5628, 0.604, 0.6581, 0.6971, 0.7383, 0.7751, 0.8141, 0.8531, 0.8834, 0.9159, 0.9375, 0.9549, 0.9722, 0.9917, 1.0004, 1.0047, 1.009]},
         # 80: {
         #        "P": [36.5967, 39.3939, 39.3939, 43.1235, 45.9207, 49.6503, 53.38, 58.9744, 63.6364, 71.0956, 82.2844, 90.676, 101.8648, 111.1888, 118.648, 126.1072, 135.4312, 146.62, 157.8089, 174.5921, 193.2401, 213.7529, 237.9953, 263.1702, 293.9394, 318.1818, 348.951, 408.6247, 453.38, 497.2028, 541.0256, 589.5105, 622.1445],
         #        "y": [1.6715, 1.6026, 1.5412, 1.4595, 1.4007, 1.3369, 1.2577, 1.1861, 1.1325, 1.0661, 1.0073, 0.9741, 0.9613, 0.9664, 0.9766, 0.9971, 1.0328, 1.0788, 1.1325, 1.1964, 1.2628, 1.319, 1.3701, 1.4109, 1.4518, 1.4723, 1.4978, 1.5336, 1.5464, 1.5566, 1.5642, 1.5693, 1.5719]},
         99: {
                "P": [30.7865, 32.5843, 36.1798, 39.7753, 42.4719, 47.8652, 55.0562, 61.3483, 69.4382, 81.1236, 93.7079, 104.4944, 120.6742, 144.0449, 166.5169, 190.7865, 217.7528, 246.5169, 274.382, 301.3483, 331.9101, 359.7753, 390.3371, 426.2921, 476.6292, 517.9775],
                "y": [3.9189, 3.6689, 3.3919, 3.1351, 2.9595, 2.6824, 2.4257, 2.2703, 2.1216, 1.9662, 1.8581, 1.7838, 1.7432, 1.7568, 1.7973, 1.8784, 1.9865, 2.0473, 2.1081, 2.1486, 2.2027, 2.2297, 2.2568, 2.2838, 2.2973, 2.3041]},
         # 99.1: {
         #        "P": [1.8349, 2.7523, 2.7523, 3.6697, 3.6697, 3.6697, 4.5872, 8.2569, 10.0917, 15.5963, 24.7706, 37.6147, 54.1284, 74.3119, 100, 136.6972, 186.2385, 259.633, 344.0367, 395.4128, 512.844, 599.0826],
         #        "y": [49.8519, 34.1481, 40.2222, 21.2593, 24.6667, 29.8519, 17.7037, 13.1111, 9.7037, 7.037, 4.5185, 3.037, 2.1481, 1.8519, 1.5556, 1.4074, 1.5556, 1.8519, 2, 2, 2, 2]},
         150: {
                "P": [10.3139, 10.3139, 12.1076, 13.9013, 16.5919, 19.2825, 22.87, 30.0448, 40.8072, 60.5381, 85.6502, 113.4529, 157.3991, 213.0045, 265.0224, 317.0404, 392.3767, 476.6816, 541.2556],
                "y": [59.6, 53.6364, 46.5091, 41.5636, 35.6, 30.0727, 23.5273, 18, 13.2, 9.8545, 7.6727, 6.6545, 5.7818, 5.9273, 5.6364, 5.9273, 6.0727, 6.3636, 6.5091]},
         200: {
                "P": [19.2661, 24.7706, 26.6055, 28.4404, 32.1101, 37.6147, 42.2018, 51.3761, 64.2202, 77.9817, 97.2477, 114.6789, 144.0367, 174.3119, 206.422, 236.6972, 273.3945, 331.1927, 367.8899, 408.2569, 448.6239, 481.6514, 527.5229, 563.3028, 599.0826],
                "y": [79.7674, 71.9934, 65.0166, 57.6412, 51.8605, 46.0797, 39.701, 33.3223, 28.1395, 23.9535, 20.5648, 18.5714, 16.1794, 14.7841, 14.186, 13.7874, 13.588, 13.588, 13.588, 13.7874, 13.9867, 13.9867, 14.186, 14.186, 14.3854]},
         250: {
                "P": [50.8121, 60.0928, 76.7981, 93.5035, 112.065, 132.4826, 152.9002, 170.5336, 199.3039, 228.0742, 269.8376, 318.0974, 364.5012, 414.6172, 470.3016, 518.5615, 563.109, 599.3039],
                "y": [79.9668, 68.6047, 56.0465, 48.0731, 42.4917, 37.907, 34.7176, 32.9236, 30.7309, 29.5349, 28.3389, 27.7409, 27.1429, 27.5415, 27.7409, 27.7409, 28.7375, 28.3389]},
         }

xdata = {
         20: {
                "P": [3.9648, 12.7753, 24.2291, 32.1586, 41.8502, 50.6608, 55.9471, 64.7577, 73.5683, 89.4273, 103.5242, 125.5507, 147.5771, 170.4846, 207.489, 245.3744, 276.2115, 309.6916, 332.5991, 356.3877, 388.9868, 415.4185, 445.3744, 486.7841, 542.2907],
                "x": [0.2566, 0.7743, 1.2655, 1.7168, 2.0619, 2.3274, 2.4602, 2.5398, 2.5531, 2.6062, 2.6195, 2.6858, 2.6991, 2.7655, 2.8053, 2.8982, 2.9381, 2.9912, 3.0044, 3.0442, 3.0973, 3.1239, 3.177, 3.2168, 3.2832]},
         31: {
                "P": [2.0225, 11.9101, 26.2921, 38.8764, 54.1573, 63.1461, 68.5393, 73.9326, 85.618, 117.9775, 142.2472, 171.9101, 197.0787, 223.1461, 261.7978, 293.2584, 334.6067, 382.2472, 452.3596, 525.1685, 593.4831],
                "x": [0.0633, 0.6063, 1.1222, 1.5294, 1.991, 2.1674, 2.2353, 2.3032, 2.3167, 2.3846, 2.4389, 2.5339, 2.5611, 2.6018, 2.6968, 2.7511, 2.8054, 2.8869, 2.9683, 3.0769, 3.1584]},
         # 40: {
         #        "P": [3.0488, 17.6829, 44.2073, 71.6463, 83.5366, 97.2561, 143.9024, 221.6463, 316.7683, 392.6829, 473.1707, 553.6585, 612.1951],
         #        "x": [0.0685, 0.6301, 1.4384, 1.9863, 2.0959, 2.2055, 2.3151, 2.4658, 2.6438, 2.7534, 2.8493, 2.9726, 3.0411]},
         60: {
                "P": [6.1503, 23.4624, 43.508, 55.3531, 72.6651, 88.1549, 110.0228, 129.1572, 154.6697, 253.9863, 342.369, 444.4191, 520.0456, 595.672],
                "x": [0.1818, 0.5636, 1.0136, 1.2455, 1.5455, 1.7091, 1.8727, 1.9682, 2.0773, 2.2818, 2.4727, 2.6091, 2.7182, 2.8136]},
         # 80: {
         #        "P": [5.8296, 20.1794, 36.3229, 50.6726, 67.713, 84.7534, 101.7937, 118.8341, 136.7713, 175.3363, 223.7668, 298.2063, 382.5112, 458.7444, 526.9058, 617.4888],
         #        "x": [0.1429, 0.4194, 0.6959, 0.9724, 1.1797, 1.3871, 1.5253, 1.6359, 1.7742, 1.9401, 2.106, 2.2719, 2.4101, 2.5207, 2.6728, 2.7972]},
         99: {
                "P": [26.9406, 47.032, 68.9498, 85.3881, 112.7854, 137.4429, 165.7534, 191.3242, 233.3333, 273.516, 334.7032, 383.105, 446.1187, 518.2648, 598.6301],
                "x": [0.4533, 0.7617, 1.0981, 1.2664, 1.5187, 1.6729, 1.8271, 1.9813, 2.1215, 2.2757, 2.4159, 2.5421, 2.6542, 2.7944, 2.9065]},
         # 99.1: {
         #        "P": [0.4878, 10.2439, 20, 28.7805, 39.5122, 51.2195, 70.7317, 82.439, 99.0244, 119.5122, 139.0244, 169.2683, 183.9024, 205.3659, 231.7073, 255.122, 278.5366, 301.9512, 330.2439, 355.6098, 380.9756, 408.2927, 437.561, 464.878, 500, 532.1951, 559.5122, 579.0244, 600.4878],
         #        "x": [0.0298, 0.1319, 0.3362, 0.4766, 0.6936, 0.8213, 1.0511, 1.2298, 1.3702, 1.5617, 1.7149, 1.8681, 1.9319, 2.0213, 2.0979, 2.1617, 2.2383, 2.3021, 2.3787, 2.4298, 2.4936, 2.5319, 2.5957, 2.634, 2.7106, 2.7617, 2.8, 2.8638, 2.8638]},
         150: {
                "P": [5.9406, 24.7525, 42.5743, 58.4158, 78.2178, 96.0396, 114.8515, 140.5941, 162.3762, 186.1386, 213.8614, 237.6238, 263.3663, 289.1089, 313.8614, 338.6139, 365.3465, 390.099, 412.8713, 437.6238, 459.4059, 487.1287, 507.9208, 531.6832, 555.4455, 578.2178, 598.0198],
                "x": [0.0044, 0.2832, 0.5619, 0.7876, 1.0398, 1.2655, 1.4779, 1.7035, 1.8894, 2.0885, 2.2743, 2.4336, 2.5398, 2.6858, 2.7788, 2.8982, 3.0177, 3.1239, 3.2035, 3.2832, 3.3628, 3.4425, 3.5354, 3.6018, 3.6814, 3.7345, 3.8142]},
         200: {
                "P": [25.7426, 50.495, 79.2079, 106.9307, 129.703, 162.3762, 192.0792, 219.802, 248.5149, 274.2574, 300, 331.6832, 362.3762, 393.0693, 432.6733, 462.3762, 494.0594, 522.7723, 555.4455, 587.1287],
                "x": [0.136, 0.536, 0.952, 1.304, 1.624, 2.008, 2.328, 2.6, 2.872, 3.08, 3.288, 3.528, 3.768, 3.992, 4.216, 4.408, 4.6, 4.76, 4.92, 5.112]},
         250: {
                "P": [38.9313, 64.3766, 105.0891, 149.8728, 191.6031, 230.2799, 307.6336, 345.2926, 386.0051, 427.7354, 476.5903, 519.3384, 551.9084, 586.514],
                "x": [-0.0435, 0.4348, 1.087, 1.8043, 2.4565, 3.0435, 4.1304, 4.6957, 5.2609, 5.8261, 6.4783, 7.0435, 7.5, 7.9565]}
         }

ps = [1, 2,3,4,5,6, 7,8, 9,10,11, 13, 15, 17, 21, 23, 25, 27, 29, 31, 33, 35, 37, 39, 41, 43, 45, 47, 49, 51, 54, 57, 60 , 63, 66, 69, 72, 75, 80, 85, 90, 95, 100, 125, 150, 200, 250, 300, 350, 400, 450, 500, 550, 600]
colors = {250:"#1f77b4", 200:"#ff7f0e", 150:"#2ca02c", 99:"#d62728", 60: "#9467bd",31: "#8c564b", 20: "#e377c2"}

# plt.style.use("ggplot")
fig1, ax1 = plt.subplots()

ax1.plot([-1,-1],[1000,1000], "kx", label="Samples")
ax1.plot([-1,-1],[1000,1000], "k", label="This Study")
for t in ydata:
    label = "\\qty{" + str(t) + "}{" + "\\degreeCelsius}"
    yH = [SpycherPruss2009().calc_yH2O(p*1e5, t+273.15) for p in ps]
    ax1.plot(ps, yH, color=colors[t], label=label)

for t in ydata:
    ax1.plot(ydata[t]["P"], ydata[t]["y"], marker="x", color=colors[t], linestyle="")

ax1.set_xlabel("Pressure/\\unit{\\bar}")
ax1.set_ylabel("\\(y_{H_2O}\\)/\\unit{\\percent}")
# axs[0].set_ylim((None, 40))
ax1.set_xlim((0, 600))
ax1.set_yscale("log")
ax1.legend()

tikzplotlib.save("SP2009_validation_YH2O.tex")


fig2, ax2 = plt.subplots()

ax2.plot([-1,-1],[0,0], "kx", label="Samples")
ax2.plot([-1,-1],[0,0], "k", label="This Study")
for t in xdata:
    label = "\\qty{" + str(t) + "}{" + "\\degreeCelsius}"
    ax2.plot(xdata[t]["P"], xdata[t]["x"], marker="x", color=colors[t], linestyle="")

    xC = [SpycherPruss2009().calc_xCO2(p*1e5, t+273.15) for p in ps]
    ax2.plot(ps, xC, color=colors[t], label=label)

ax2.set_xlabel("Pressure/\\unit{\\bar}")
ax2.set_ylabel("\\(x_{CO_2}\\)/\\unit{\\percent}")
ax2.set_ylim((0,None))
ax2.set_xlim((0, 600))
ax2.legend()

tikzplotlib.save("SP2009_validation_XCO2.tex")
