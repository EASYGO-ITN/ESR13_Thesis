import matplotlib.pyplot as plt
import numpy as np
import tikzplotlib

from FluidProperties.fluid import Fluid
from copy import deepcopy

AspenProperties = {
    "WATER": {
        "Enthalpy": {
            "T": [298, 303.6122449, 309.2244898, 314.8367347, 320.4489796, 326.0612245, 331.6734694, 337.2857143,
                  342.8979592, 348.5102041, 354.122449, 359.7346939, 365.3469388, 370.9591837, 376.571429, 382.183673,
                  387.795918, 393.408163, 399.020408, 404.632653, 410.244898, 415.857143, 421.469388, 427.081633,
                  432.693878, 438.306122, 443.918367, 449.530612, 455.142857, 460.755102, 466.367347, 471.979592,
                  477.591837, 483.204082, 488.816327, 494.428571, 500.040816, 505.653061, 511.265306, 516.877551,
                  522.489796, 528.102041, 533.714286, 539.326531, 544.938776, 550.55102, 556.163265, 561.77551,
                  567.387755, 573],
            1.00: [-1.22755726, 23460.4511, 46916.2874, 70371.8656, 93831.4468, 117298.454, 140775.821, 164266.246,
                   187772.364, 211296.875, 234842.625, 258412.657, 282010.25, 305638.938, 2578551.65, 2590072.91,
                   2601503.9, 2612863.45, 2624165, 2635418.88, 2646633.45, 2657815.7, 2668971.57, 2680106.13, 2691223.8,
                   2702328.42, 2713423.34, 2724511.49, 2735595.46, 2746677.55, 2757759.78, 2768843.95, 2779931.67,
                   2791024.36, 2802123.32, 2813229.68, 2824344.5, 2835468.71, 2846603.15, 2857748.6, 2868905.76,
                   2880075.26, 2891257.69, 2902453.57, 2913663.4, 2924887.63, 2936126.68, 2947380.92, 2958650.71,
                   2969936.39],
            3.16: [199.080917, 23657.3647, 47110.0194, 70562.5799, 94019.2684, 117483.476, 140958.112, 164445.852,
                   187949.312, 211471.176, 235014.273, 258581.634, 282176.523, 305802.463, 329463.239, 353162.914,
                   376905.832, 400696.619, 424540.2, 448441.8, 2627015.65, 2639562.96, 2651903.54, 2664087.57,
                   2676146.34, 2688101.5, 2699969.35, 2711762.89, 2723492.89, 2735168.45, 2746797.41, 2758386.56,
                   2769941.84, 2781468.45, 2792970.98, 2804453.48, 2815919.56, 2827372.41, 2838814.9, 2850249.57,
                   2861678.73, 2873104.43, 2884528.54, 2895952.73, 2907378.53, 2918807.31, 2930240.34, 2941678.76,
                   2953123.63, 2964575.89],
            10.00: [832.279824, 24279.8621, 47722.4864, 71165.5317, 94613.0978, 118068.478, 141534.5, 165013.769,
                    188508.846, 212022.358, 235557.089, 259116.025, 282702.387, 306319.657, 329971.58, 353662.178,
                    377395.752, 401176.886, 425010.456, 448901.64, 472855.931, 496879.156, 520977.501, 545157.538,
                    569426.266, 593791.153, 618260.191, 642841.962, 2678493.42, 2693129.84, 2707297.42, 2721122.31,
                    2734679.1, 2748016.33, 2761168.39, 2774161.48, 2787016.56, 2799750.99, 2812379.48, 2824914.7,
                    2837367.64, 2849747.93, 2862064.05, 2874323.48, 2886532.87, 2898698.16, 2910824.62, 2922917,
                    2934979.56, 2947016.14],
            31.62: [2832.3173, 26246.3992, 49657.6063, 73070.8345, 96489.8045, 119917.504, 143356.508, 166809.211,
                    190277.987, 213765.302, 237273.789, 260806.297, 284365.919, 307956.004, 331580.176, 355242.327,
                    378946.628, 402697.528, 426499.761, 450358.354, 474278.637, 498266.26, 522327.216, 546467.868,
                    570694.978, 595015.755, 619437.898, 643969.658, 668619.906, 693398.217, 718314.967, 743381.451,
                    768610.021, 794014.258, 819609.178, 845411.478, 871439.851, 897715.374, 2703676.76, 2723240.53,
                    2741711.61, 2759375.53, 2776405.22, 2792915.01, 2808986.51, 2824681.55, 2840049.16, 2855129.45,
                    2869955.99, 2884557.3],
            100.00: [9134.10495, 32445.5819, 55760.397, 79082.0105, 102413.013, 125755.483, 149111.242, 172482.048,
                     195869.726, 219276.253, 242703.82, 266154.864, 289632.086, 313138.458, 336677.228, 360251.912,
                     383866.296, 407524.431, 431230.632, 454989.483, 478805.84, 502684.842, 526631.924, 550652.839,
                     574753.681, 598940.912, 623221.405, 647602.48, 672091.963, 696698.242, 721430.343, 746298.01,
                     771311.812, 796483.258, 821824.941, 847350.71, 873075.876, 899017.466, 925194.537, 951628.558,
                     978343.903, 1005368.47, 1032734.49, 1060479.55, 1088648.05, 1117293.03, 1146478.91, 1176285.16,
                     1206811.93, 1238188.48]
        },
        "Entropy": {
            "T": [298, 303.6122449, 309.2244898, 314.8367347, 320.4489796, 326.0612245, 331.6734694, 337.2857143,
                  342.8979592, 348.5102041, 354.122449, 359.7346939, 365.3469388, 370.9591837, 376.571429, 382.183673,
                  387.795918, 393.408163, 399.020408, 404.632653, 410.244898, 415.857143, 421.469388, 427.081633,
                  432.693878, 438.306122, 443.918367, 449.530612, 455.142857, 460.755102, 466.367347, 471.979592,
                  477.591837, 483.204082, 488.816327, 494.428571, 500.040816, 505.653061, 511.265306, 516.877551,
                  522.489796, 528.102041, 533.714286, 539.326531, 544.938776, 550.55102, 556.163265, 561.77551,
                  567.387755, 573],
            1.00: [0.000339981509, 77.9986647, 154.54922, 229.721997, 303.579105, 376.176826, 447.56707, 517.798427,
                   586.9169, 654.966433, 721.989278, 788.026255, 853.116931, 917.299757, 7014.83099, 7045.20073,
                   7074.89317, 7103.97604, 7132.50049, 7160.50787, 7188.03297, 7215.1058, 7241.75265, 7267.99679,
                   7293.859, 7319.35793, 7344.51042, 7369.33176, 7393.8359, 7418.03561, 7441.94262, 7465.56779,
                   7488.92114, 7512.01203, 7534.84914, 7557.44062, 7579.79411, 7601.91677, 7623.81538, 7645.49632,
                   7666.96564, 7688.22907, 7709.29207, 7730.15982, 7750.83727, 7771.32913, 7791.63994, 7811.77399,
                   7831.73545, 7851.52829],
            3.16: [-0.0551653682, 77.9318716, 154.472043, 229.635147, 303.483148, 376.072209, 447.454148, 517.677477,
                   586.788134, 654.830008, 721.845304, 787.874796, 852.958015, 917.133374, 980.438273, 1042.90917,
                   1104.58167, 1165.49056, 1225.6699, 1285.15307, 6618.71758, 6649.09585, 6678.57292, 6707.29097,
                   6735.34262, 6762.7948, 6789.69974, 6816.10028, 6842.03275, 6867.52851, 6892.61505, 6917.31663,
                   6941.65486, 6965.64906, 6989.31662, 7012.67326, 7035.73322, 7058.5095, 7081.01398, 7103.25757,
                   7125.25033, 7147.00152, 7168.51977, 7189.81307, 7210.8889, 7231.75423, 7252.41562, 7272.87919,
                   7293.15076, 7313.23578],
            10.00: [-0.230999382, 77.7204567, 154.22789, 229.360496, 303.179776, 375.741526, 447.09727, 517.295276,
                    586.381279, 654.398996, 721.390478, 787.396365, 852.456064, 916.607875, 979.889087, 1042.33606,
                    1103.98429, 1164.86846, 1225.02254, 1284.47979, 1343.27291, 1401.43403, 1458.9949, 1515.98686,
                    1572.44107, 1628.38852, 1683.86024, 1738.88738, 6232.42397, 6264.38643, 6294.95013, 6324.41758,
                    6352.97192, 6380.73551, 6407.79744, 6434.22702, 6460.08067, 6485.40581, 6510.24303, 6534.62762,
                    6558.59053, 6582.15909, 6605.35761, 6628.20779, 6650.72911, 6672.93913, 6694.85372, 6716.4873,
                    6737.853, 6758.96283],
            31.62: [-0.790130433, 77.0499414, 153.454832, 228.491872, 302.221118, 374.697231, 445.970818, 516.089393,
                    585.09806, 653.039994, 719.956774, 785.888621, 850.874558, 914.95253, 978.159494, 1040.53149,
                    1102.10368, 1162.91045, 1222.98544, 1282.36159, 1341.07124, 1399.14618, 1456.61774, 1513.51688,
                    1569.87428, 1625.72045, 1681.08586, 1736.00106, 1790.49683, 1844.60435, 1898.35542, 1951.78262,
                    2004.91964, 2057.80152, 2110.46505, 2162.94918, 2215.29554, 2267.54912, 5809.20269, 5847.26186,
                    5882.80673, 5916.43487, 5948.51263, 5979.28567, 6008.93152, 6037.58624, 6065.35854, 6092.33792,
                    6118.59959, 6144.20773],
            100.00: [-2.58883076, 74.9100947, 151.000373, 225.743777, 299.196064, 371.408497, 442.428944, 512.302661,
                     581.072862, 648.781101, 715.467543, 781.17115, 845.929803, 909.780389, 972.758864, 1034.9003,
                     1096.23895, 1156.80823, 1216.64085, 1275.76879, 1334.22337, 1392.03535, 1449.23492, 1505.85186,
                     1561.91555, 1617.45509, 1672.4994, 1727.07731, 1781.21768, 1834.94957, 1888.30233, 1941.3058,
                     1993.99051, 2046.38784, 2098.53036, 2150.45204, 2202.18866, 2253.77821, 2305.26142, 2356.68237,
                     2408.08929, 2459.5356, 2511.08116, 2562.79395, 2614.75238, 2667.04827, 2719.79112, 2773.11415,
                     2827.18318, 2882.21015]
        },
        "Density": {
            "T": [298, 303.6122449, 309.2244898, 314.8367347, 320.4489796, 326.0612245, 331.6734694, 337.2857143,
                  342.8979592, 348.5102041, 354.122449, 359.7346939, 365.3469388, 370.9591837, 376.571429, 382.183673,
                  387.795918, 393.408163, 399.020408, 404.632653, 410.244898, 415.857143, 421.469388, 427.081633,
                  432.693878, 438.306122, 443.918367, 449.530612, 455.142857, 460.755102, 466.367347, 471.979592,
                  477.591837, 483.204082, 488.816327, 494.428571, 500.040816, 505.653061, 511.265306, 516.877551,
                  522.489796, 528.102041, 533.714286, 539.326531, 544.938776, 550.55102, 556.163265, 561.77551,
                  567.387755, 573],
            1.00: [997.086075, 995.508975, 993.659344, 991.560774, 989.23261, 986.690894, 983.949048, 981.018372,
                   977.908429, 974.627332, 971.181963, 967.578144, 963.820775, 959.913932, 0.583891623, 0.574700222,
                   0.565839995, 0.55728692, 0.549020594, 0.541023181, 0.533278823, 0.525773264, 0.518493595,
                   0.511428056, 0.504565882, 0.497897177, 0.491412811, 0.485104332, 0.478963891, 0.472984181,
                   0.467158381, 0.461480108, 0.455943378, 0.45054257, 0.445272393, 0.440127858, 0.435104255,
                   0.430197133, 0.425402273, 0.420715679, 0.416133558, 0.411652303, 0.407268486, 0.402978844,
                   0.398780264, 0.394669781, 0.390644561, 0.386701901, 0.382839212, 0.379054022],
            3.16: [997.183639, 995.605244, 993.754687, 991.65551, 989.327023, 986.785236, 984.043548, 981.113241,
                   978.003865, 974.723521, 971.279084, 967.67637, 963.920275, 960.014875, 955.963511, 951.768847,
                   947.432925, 942.957198, 938.342558, 933.589351, 1.72567406, 1.69863, 1.67270861, 1.64779273,
                   1.62379392, 1.60064058, 1.57827217, 1.5566362, 1.53568635, 1.51538135, 1.49568412, 1.47656115,
                   1.45798197, 1.43991877, 1.42234607, 1.40524044, 1.38858022, 1.3723454, 1.35651738, 1.34107883,
                   1.32601359, 1.31130656, 1.29694356, 1.28291129, 1.26919722, 1.25578955, 1.24267715, 1.22984948,
                   1.21729656, 1.20500895],
            10.00: [997.491869, 995.90938, 994.055894, 991.954799, 989.625284, 987.083267, 984.342071, 981.412923,
                    978.305328, 975.027352, 971.585846, 967.98661, 964.234528, 960.333674, 956.287388, 952.098342,
                    947.76859, 943.299601, 938.692288, 933.947027, 929.063662, 924.041513, 918.879367, 913.57547,
                    908.127506, 902.532572, 896.787142, 890.887023, 5.11157713, 5.02647559, 4.94597392, 4.86938713,
                    4.79624062, 4.7261768, 4.65890986, 4.59420235, 4.53185191, 4.47168318, 4.41354241, 4.35729362,
                    4.30281567, 4.25000001, 4.1987489, 4.1489739, 4.10059466, 4.05353788, 4.00773649, 3.96312887,
                    3.91965827, 3.87727224],
            31.62: [998.463653, 996.868243, 995.005493, 992.898307, 990.565498, 988.02269, 985.282975, 982.357399,
                    979.255326, 975.984716, 972.552339, 968.963943, 965.224377, 961.3377, 957.307256, 953.135737,
                    948.82523, 944.377256, 939.792794, 935.072303, 930.215725, 925.2225, 920.091552, 914.821286,
                    909.409573, 903.853721, 898.150449, 892.295847, 886.285325, 880.113553, 873.774387, 867.260775,
                    860.56465, 853.676789, 846.586648, 839.282149, 831.749424, 823.972483, 15.7336043, 15.4026862,
                    15.0986992, 14.8164905, 14.5525657, 14.30437, 14.0699336, 13.8476796, 13.6363132, 13.4347506,
                    13.2420727, 13.0574911],
            100.00: [1001.50781, 999.871809, 997.979772, 995.853115, 993.50949, 990.963611, 988.227848, 985.312681,
                     982.227032, 978.978522, 975.573667, 972.018034, 968.316359, 964.472643, 960.490223, 956.371836,
                     952.11966, 947.735352, 943.220074, 938.574513, 933.798891, 928.892975, 923.856078, 918.687052,
                     913.384281, 907.945669, 902.368614, 896.649982, 890.786079, 884.772601, 878.604588, 872.276361,
                     865.781441, 859.112468, 852.261077, 845.217773, 837.971759, 830.510731, 822.820628, 814.885306,
                     806.686137, 798.20149, 789.406054, 780.269954, 770.75756, 760.825859, 750.422189, 739.480984,
                     727.918964, 715.627759]
        },
    },
    "BUTANE": {
        "Enthalpy": {
            "T": [298, 303.6122449, 309.2244898, 314.8367347, 320.4489796, 326.0612245, 331.6734694, 337.2857143,
                  342.8979592, 348.5102041, 354.122449, 359.7346939, 365.3469388, 370.9591837, 376.571429, 382.183673,
                  387.795918, 393.408163, 399.020408, 404.632653, 410.244898, 415.857143, 421.469388, 427.081633,
                  432.693878, 438.306122, 443.918367, 449.530612, 455.142857, 460.755102, 466.367347, 471.979592,
                  477.591837, 483.204082, 488.816327, 494.428571, 500.040816, 505.653061, 511.265306, 516.877551,
                  522.489796, 528.102041, 533.714286, 539.326531, 544.938776, 550.55102, 556.163265, 561.77551,
                  567.387755, 573],
            1.00: [58.2089639, 9831.41365, 19727.7771, 29749.6342, 39898.9988, 50177.5955, 60586.8828, 71128.0725,
                   81802.1497, 92609.8997, 103551.937, 114628.731, 125840.615, 137187.793, 148670.336, 160288.188,
                   172041.178, 183929.037, 195951.408, 208107.861, 220397.9, 232820.97, 245376.458, 258063.704,
                   270881.999, 283830.595, 296908.708, 310115.521, 323450.189, 336911.845, 350499.598, 364212.543,
                   378049.758, 392010.309, 406093.253, 420297.639, 434622.511, 449066.909, 463629.87, 478310.432,
                   493107.631, 508020.509, 523048.106, 538189.469, 553443.648, 568809.701, 584286.688, 599873.679,
                   615569.75, 631373.984],
            3.16: [-368117.367, -354337.012, 10473.7447, 20979.6229, 31569.7123, 42251.2905, 53030.4398, 63912.2319,
                   74900.887, 85999.9373, 97212.3866, 108540.829, 119987.503, 131554.299, 143242.75, 155054.049,
                   166989.094, 179048.546, 191232.873, 203542.394, 215977.295, 228537.643, 241223.394, 254034.402,
                   266970.426, 280031.141, 293216.149, 306524.983, 319957.119, 333511.981, 347188.948, 360987.36,
                   374906.523, 388945.712, 403104.178, 417381.148, 431775.831, 446287.422, 460915.1, 475658.035,
                   490515.388, 505486.313, 520569.961, 535765.477, 551072.006, 566488.693, 582014.681, 597649.117,
                   613391.149, 629239.928],
            10.00: [-367646.719, -353900.651, -339969.933, -325845.28, -311516.327, -296971.307, -282196.622,
                    -267176.241, -251890.857, -236316.639, 72408.7622, 85157.8483, 97865.3772, 110562.069, 123271.242,
                    136010.647, 148793.981, 161632.084, 174533.81, 187506.557, 200556.593, 213689.231, 226908.957,
                    240219.538, 253624.116, 267125.302, 280725.255, 294425.752, 308228.245, 322133.907, 336143.675,
                    350258.281, 364478.279, 378804.067, 393235.909, 407773.953, 422418.239, 437168.72, 452025.268,
                    466987.685, 482055.712, 497229.035, 512507.294, 527890.085, 543376.97, 558967.478, 574661.109,
                    590457.34, 606355.628, 622355.409],
            31.62: [-366100.092, -352452.257, -338631.964, -324632.01, -310444.605, -296061.221, -281472.383,
                    -266667.413, -251634.086, -236358.164, -220822.76, -205007.435, -188886.874, -172428.884,
                    -155591.216, -138316.26, -120521.564, -102081.366, -82786.0735, -62236.1033, -39465.7068,
                    129504.822, 153545.174, 173891.686, 192583.634, 210330.085, 227473.289, 244208.098, 260657.389,
                    276904.264, 293007.844, 309011.82, 324949.44, 340846.601, 356723.853, 372597.757, 388481.823,
                    404387.194, 420323.138, 436297.423, 452316.599, 468386.217, 484511.002, 500694.989, 516941.632,
                    533253.896, 549634.323, 566085.098, 582608.097, 599204.928],
            100.00: [-360737.537, -347326.004, -333766.566, -320055.278, -306188.19, -292161.325, -277970.652,
                     -263612.063, -249081.342, -234374.13, -219485.892, -204411.877, -189147.068, -173686.134,
                     -158023.367, -142152.612, -126067.185, -109759.766, -93222.2883, -76445.7863, -59420.2278,
                     -42134.3102, -24575.2333, -6728.46437, 11422.4576, 29895.9879, 48712.3368, 67892.6262, 87456.9722,
                     107420.876, 127789.368, 148549.049, 169659.891, 191051.021, 212625.257, 234273.242, 255891.432,
                     277395.675, 298726.431, 319847.293, 340740.533, 361402.295, 381838.48, 402061.498, 422087.764,
                     441935.839, 461625.075, 481174.688, 500603.152, 519927.844]
        },
        "Entropy": {
            "T": [298, 303.6122449, 309.2244898, 314.8367347, 320.4489796, 326.0612245, 331.6734694, 337.2857143,
                  342.8979592, 348.5102041, 354.122449, 359.7346939, 365.3469388, 370.9591837, 376.571429, 382.183673,
                  387.795918, 393.408163, 399.020408, 404.632653, 410.244898, 415.857143, 421.469388, 427.081633,
                  432.693878, 438.306122, 443.918367, 449.530612, 455.142857, 460.755102, 466.367347, 471.979592,
                  477.591837, 483.204082, 488.816327, 494.428571, 500.040816, 505.653061, 511.265306, 516.877551,
                  522.489796, 528.102041, 533.714286, 539.326531, 544.938776, 550.55102, 556.163265, 561.77551,
                  567.387755, 573],
            1.00: [2.02197728, 34.5123356, 66.8095192, 98.9279625, 130.880325, 162.677709, 194.329843, 225.845224,
                   257.231264, 288.494436, 319.640415, 350.674201, 381.600191, 412.422225, 443.143613, 473.767189,
                   504.29536, 534.730178, 565.073388, 595.32648, 625.490719, 655.567174, 685.556739, 715.460151,
                   745.278016, 775.01082, 804.658948, 834.2227, 863.702304, 893.097925, 922.40968, 951.637641,
                   980.781849, 1009.84232, 1038.81904, 1067.712, 1096.52115, 1125.24647, 1153.8879, 1182.44541,
                   1210.91896, 1239.30852, 1267.61405, 1295.83553, 1323.97296, 1352.02633, 1379.99566, 1407.88096,
                   1435.68227, 1463.39964],
            3.16: [-1354.22791, -1308.41611, -119.459598, -85.789692, -52.4496215, -19.4054116, 13.3715375, 45.9053633,
                   78.2165033, 110.322409, 142.23819, 173.977095, 205.55078, 236.969414, 268.241757, 299.375287,
                   330.376384, 361.250543, 392.002548, 422.636601, 453.156411, 483.565243, 513.865969, 544.061104,
                   574.152846, 604.143116, 634.033591, 663.825733, 693.520826, 723.119989, 752.624207, 782.034344,
                   811.351161, 840.575333, 869.707455, 898.748058, 927.697619, 956.556566, 985.325286, 1014.00413,
                   1042.59344, 1071.0935, 1099.50461, 1127.82703, 1156.06103, 1184.20685, 1212.26473, 1240.23491,
                   1268.11763, 1295.91313],
            10.00: [-1356.64782, -1310.94999, -1265.48659, -1220.21945, -1175.10898, -1130.11336, -1085.18733,
                    -1040.28062, -995.335844, -950.285317, -74.5939288, -38.874101, -3.82200774, 30.6661896, 64.6698372,
                    98.2500826, 131.454857, 164.322717, 196.885554, 229.170311, 261.200033, 292.994516, 324.570787,
                    355.943497, 387.125275, 418.127038, 448.958264, 479.627214, 510.141126, 540.506365, 570.728552,
                    600.812669, 630.763147, 660.583939, 690.278585, 719.850262, 749.30183, 778.635877, 807.854744,
                    836.960562, 865.955274, 894.840657, 923.618343, 952.289836, 980.856522, 1009.31969, 1037.68054,
                    1065.94019, 1094.09969, 1122.16001],
            31.62: [-1364.05209, -1318.68078, -1273.57771, -1228.71013, -1184.04521, -1139.54953, -1095.18851,
                    -1050.9257, -1006.72192, -962.534071, -918.313593, -874.004255, -829.538999, -784.835156,
                    -739.786893, -694.252602, -648.032374, -600.824114, -552.127156, -500.989464, -445.11069,
                    -36.8430746, 20.5951013, 68.5575233, 112.042167, 152.794148, 191.659433, 229.121856, 265.488012,
                    300.966313, 335.70584, 369.817419, 403.385945, 436.47803, 469.146973, 501.436126, 533.381241,
                    565.012162, 596.354056, 627.428348, 658.253423, 688.845178, 719.217445, 749.382339, 779.350528,
                    809.131451, 838.733506, 868.164194, 897.430245, 926.537719],
            100.00: [-1385.40899, -1340.82315, -1296.57127, -1252.6287, -1208.97207, -1165.57915, -1122.42868,
                     -1079.50023, -1036.77409, -994.231081, -951.852437, -909.619675, -867.514445, -825.518377,
                     -783.612922, -741.779178, -699.997688, -658.248217, -616.509495, -574.758915, -532.972181,
                     -491.122916, -449.182224, -407.118275, -364.895999, -322.477104, -279.820777, -236.885702,
                     -193.634316, -150.040508, -106.101683, -61.8546095, -17.3908213, 27.1371449, 71.5278816,
                     115.562083, 159.039521, 201.805228, 243.757765, 284.844027, 325.048583, 364.382913, 402.87652,
                     440.570111, 477.510529, 513.747092, 549.329051, 584.303929, 618.71652, 652.608372]
        },
        "Density": {
            "T": [298, 303.6122449, 309.2244898, 314.8367347, 320.4489796, 326.0612245, 331.6734694, 337.2857143,
                  342.8979592, 348.5102041, 354.122449, 359.7346939, 365.3469388, 370.9591837, 376.571429, 382.183673,
                  387.795918, 393.408163, 399.020408, 404.632653, 410.244898, 415.857143, 421.469388, 427.081633,
                  432.693878, 438.306122, 443.918367, 449.530612, 455.142857, 460.755102, 466.367347, 471.979592,
                  477.591837, 483.204082, 488.816327, 494.428571, 500.040816, 505.653061, 511.265306, 516.877551,
                  522.489796, 528.102041, 533.714286, 539.326531, 544.938776, 550.55102, 556.163265, 561.77551,
                  567.387755, 573],
            1.00: [2.41764881, 2.36842732, 2.32137809, 2.27634256, 2.23317899, 2.1917601, 2.15197117, 2.11370831,
                   2.07687718, 2.04139176, 2.00717341, 1.97415007, 1.94225547, 1.91142859, 1.8816131, 1.85275684,
                   1.82481146, 1.797732, 1.77147663, 1.74600631, 1.72128459, 1.69727736, 1.67395268, 1.65128059,
                   1.62923293, 1.60778324, 1.58690659, 1.56657949, 1.54677976, 1.52748646, 1.50867979, 1.490341,
                   1.47245233, 1.45499694, 1.43795885, 1.42132288, 1.40507461, 1.3892003, 1.3736869, 1.35852196,
                   1.34369362, 1.32919054, 1.31500195, 1.30111751, 1.28752736, 1.27422208, 1.26119265, 1.24843043,
                   1.23592714, 1.22367487],
            3.16: [573.149716, 566.494411, 7.84118574, 7.65334331, 7.47685879, 7.31049937, 7.15322722, 7.00415982,
                   6.86253985, 6.7277121, 6.59910567, 6.47622009, 6.35861418, 6.24589709, 6.13772069, 6.03377338,
                   5.93377489, 5.83747202, 5.74463521, 5.65505563, 5.56854274, 5.48492219, 5.40403403, 5.32573116,
                   5.24987795, 5.17634905, 5.10502837, 5.03580816, 4.96858823, 4.90327524, 4.83978208, 4.77802732,
                   4.71793473, 4.65943282, 4.60245449, 4.54693663, 4.49281984, 4.44004813, 4.38856865, 4.33833151,
                   4.28928949, 4.2413979, 4.1946144, 4.14889882, 4.10421304, 4.06052081, 4.01778769, 3.97598088,
                   3.93506914, 3.89502271],
            10.00: [574.326876, 567.756883, 561.032746, 554.137265, 547.050431, 539.748699, 532.203996, 524.382331,
                    516.24181, 507.729681, 24.6133033, 23.8394086, 23.1388787, 22.4991498, 21.9106915, 21.366087,
                    20.8594368, 20.3859627, 19.9417382, 19.5234974, 19.1284961, 18.7544074, 18.3992417, 18.0612843,
                    17.7390467, 17.4312282, 17.136685, 16.8544057, 16.5834915, 16.3231396, 16.0726301, 15.8313147,
                    15.5986075, 15.373977, 15.1569397, 14.9470543, 14.7439169, 14.5471569, 14.3564332, 14.1714315,
                    13.991861, 13.8174527, 13.6479568, 13.483141, 13.322789, 13.1666988, 13.014682, 12.8665618,
                    12.7221729, 12.5813597],
            31.62: [577.903092, 571.579118, 565.128509, 558.538784, 551.795808, 544.883441, 537.783098, 530.473159,
                    522.928196, 515.117908, 507.005658, 498.546376, 489.683481, 480.344198, 470.432113, 459.814687,
                    448.300881, 435.597408, 421.212318, 404.201353, 382.265339, 102.12699, 91.3295671, 84.4951857,
                    79.4343299, 75.4061329, 72.0603811, 69.2013139, 66.7075948, 64.4985127, 62.5175391, 60.723491,
                    59.0854146, 57.5794464, 56.1867975, 54.892408, 53.6840212, 52.5515287, 51.486496, 50.4818129,
                    49.5314301, 48.6301587, 47.7735144, 46.957596, 46.1789884, 45.4346852, 44.7220267, 44.0386478,
                    43.3824369, 42.7515006],
            100.00: [588.014512, 582.295403, 576.504568, 570.636789, 564.686507, 558.647787, 552.514277, 546.279175,
                     539.935178, 533.47443, 526.888472, 520.16817, 513.303651, 506.284215, 499.09825, 491.733117,
                     484.175033, 476.408925, 468.418264, 460.184873, 451.688712, 442.907644, 433.817202, 424.390409,
                     414.59775, 404.407504, 393.786789, 382.703954, 371.133215, 359.062687, 346.506657, 333.521283,
                     320.219184, 306.773884, 293.404917, 280.343793, 267.794808, 255.90837, 244.774001, 234.427981,
                     224.866776, 216.060258, 207.962349, 200.518825, 193.672694, 187.367714, 181.550521, 176.171783,
                     171.186682, 166.554984]
        },
    },
    "PENTANE": {
        "Enthalpy": {
            "T": [298, 303.6122449, 309.2244898, 314.8367347, 320.4489796, 326.0612245, 331.6734694, 337.2857143,
                  342.8979592, 348.5102041, 354.122449, 359.7346939, 365.3469388, 370.9591837, 376.571429, 382.183673,
                  387.795918, 393.408163, 399.020408, 404.632653, 410.244898, 415.857143, 421.469388, 427.081633,
                  432.693878, 438.306122, 443.918367, 449.530612, 455.142857, 460.755102, 466.367347, 471.979592,
                  477.591837, 483.204082, 488.816327, 494.428571, 500.040816, 505.653061, 511.265306, 516.877551,
                  522.489796, 528.102041, 533.714286, 539.326531, 544.938776, 550.55102, 556.163265, 561.77551,
                  567.387755, 573],
            1.00: [-1.10754519, 13066.9711, 384045.262, 393967.016, 404010.846, 414178.592, 424471.969, 434892.51,
                   445441.536, 456120.134, 466929.164, 477869.278, 488940.957, 500144.537, 511480.243, 522948.209,
                   534548.498, 546281.107, 558145.977, 570142.997, 582271.999, 594532.767, 606925.029, 619448.465,
                   632102.704, 644887.33, 657801.877, 670845.84, 684018.669, 697319.778, 710748.544, 724304.31,
                   737986.387, 751794.058, 765726.576, 779783.17, 793963.046, 808265.384, 822689.349, 837234.083,
                   851898.71, 866682.342, 881584.071, 896602.978, 911738.132, 926988.59, 942353.397, 957831.59,
                   973422.199, 989124.245],
            3.16: [179.857661, 13242.4704, 26452.7602, 39815.0229, 53333.6959, 67013.4172, 80859.0967, 94876.0039,
                   109069.877, 446784.101, 458028.449, 469372.662, 480820.303, 492374.27, 504036.96, 515810.409,
                   527696.378, 539696.41, 551811.867, 564043.947, 576393.696, 588862.011, 601449.648, 614157.23,
                   626985.245, 639934.059, 653003.926, 666194.988, 679507.291, 692940.788, 706495.351, 720170.772,
                   733966.775, 747883.021, 761919.112, 776074.594, 790348.968, 804741.687, 819252.165, 833879.775,
                   848623.86, 863483.727, 878458.656, 893547.9, 908750.687, 924066.223, 939493.693, 955032.264,
                   970681.087, 986439.296],
            10.00: [755.037064, 13800.7782, 26992.521, 40334.3488, 53830.449, 67485.1643, 81303.0528, 95288.9615,
                    109448.117, 123786.241, 138309.692, 153025.658, 167942.388, 183069.523, 198418.516, 214003.235,
                    229840.804, 245952.848, 526419.005, 540073.245, 553689.092, 567293.863, 580908.659, 594550.132,
                    608231.636, 621964.017, 635756.168, 649615.439, 663547.938, 677558.771, 691652.213, 705831.855,
                    720100.716, 734461.332, 748915.827, 763465.978, 778113.256, 792858.875, 807703.819, 822648.872,
                    837694.646, 852841.595, 868090.038, 883440.17, 898892.079, 914445.755, 930101.1, 945857.937,
                    961716.02, 977675.038],
            31.62: [2601.48342, 15597.676, 28735.1726, 42017.5015, 55448.2056, 69030.8756, 82769.1869, 96666.9439,
                    110728.132, 124956.981, 139358.043, 153936.285, 168697.205, 183646.976, 198792.621, 214142.249,
                    229705.342, 245493.158, 261519.255, 277800.231, 294356.776, 311215.212, 328409.864, 345986.824,
                    364010.339, 382574.407, 401825.979, 422018.045, 443659.026, 468125.162, 591991.658, 625134.361,
                    648758.884, 669579.419, 688993.496, 707566.375, 725589.717, 743235.865, 760615.987, 777806.341,
                    794861.674, 811822.69, 828720.495, 845579.393, 862418.718, 879254.083, 896098.245, 912961.742,
                    929853.346, 946780.412],
            100.00: [8674.2688, 21543.8185, 34544.0826, 47677.5667, 60946.6609, 74353.6527, 87900.74, 101590.045,
                     115423.629, 129403.509, 143531.678, 157810.119, 172240.827, 186825.833, 201567.22, 216467.148,
                     231527.878, 246751.797, 262141.441, 277699.525, 293428.973, 309332.945, 325414.873, 341678.489,
                     358127.859, 374767.408, 391601.942, 408636.657, 425877.133, 443329.296, 460999.345, 478893.621,
                     497018.401, 515379.591, 533982.304, 552830.286, 571925.217, 591265.889, 610847.347, 630660.115,
                     650689.672, 670916.349, 691315.759, 711859.753, 732517.761, 753258.281, 774050.292, 794864.442,
                     815673.967, 836455.371]
        },
        "Entropy": {
            "T": [298, 303.6122449, 309.2244898, 314.8367347, 320.4489796, 326.0612245, 331.6734694, 337.2857143,
                  342.8979592, 348.5102041, 354.122449, 359.7346939, 365.3469388, 370.9591837, 376.571429, 382.183673,
                  387.795918, 393.408163, 399.020408, 404.632653, 410.244898, 415.857143, 421.469388, 427.081633,
                  432.693878, 438.306122, 443.918367, 449.530612, 455.142857, 460.755102, 466.367347, 471.979592,
                  477.591837, 483.204082, 488.816327, 494.428571, 500.040816, 505.653061, 511.265306, 516.877551,
                  522.489796, 528.102041, 533.714286, 539.326531, 544.938776, 550.55102, 556.163265, 561.77551,
                  567.387755, 573],
            1.00: [0.00343903078, 43.4474704, 1245.04492, 1276.84257, 1308.4627, 1339.91718, 1371.21687, 1402.37156,
                   1433.38991, 1464.2795, 1495.04689, 1525.69775, 1556.23701, 1586.669, 1616.99753, 1647.22603,
                   1677.35756, 1707.39492, 1737.34061, 1767.19693, 1796.96593, 1826.64944, 1856.24913, 1885.76644,
                   1915.20268, 1944.55897, 1973.83629, 2003.03549, 2032.1573, 2061.20234, 2090.17111, 2119.06405,
                   2147.8815, 2176.62373, 2205.29093, 2233.88325, 2262.40079, 2290.84359, 2319.21165, 2347.50493,
                   2375.72337, 2403.86687, 2431.93532, 2459.92855, 2487.84642, 2515.68875, 2543.45534, 2571.146,
                   2598.76051, 2626.29865],
            3.16: [-0.556760431, 42.8691022, 85.9814999, 128.805477, 171.365197, 213.684184, 255.785585, 297.692454,
                   339.428086, 1312.16027, 1344.16692, 1375.95006, 1407.52647, 1438.9103, 1470.11376, 1501.14756,
                   1532.02121, 1562.74328, 1593.32149, 1623.76284, 1654.07367, 1684.2597, 1714.32609, 1744.27746,
                   1774.11797, 1803.85129, 1833.48075, 1863.00926, 1892.43943, 1921.77357, 1951.01374, 1980.16173,
                   2009.21914, 2038.18739, 2067.06771, 2095.8612, 2124.5688, 2153.19134, 2181.72955, 2210.18406,
                   2238.5554, 2266.84404, 2295.05036, 2323.1747, 2351.21733, 2379.17848, 2407.05832, 2434.85699,
                   2462.57462, 2490.21126],
            10.00: [-2.31497185, 41.0548093, 84.1066858, 126.865181, 169.353846, 211.595486, 253.612392, 295.426597,
                    337.06016, 378.535494, 419.875757, 461.105326, 502.250386, 543.339691, 584.405557, 625.485223,
                    666.622755, 707.871842, 1412.69655, 1446.67769, 1480.09643, 1513.0342, 1545.55432, 1577.70709,
                    1609.53319, 1641.06593, 1672.33296, 1703.35741, 1734.1588, 1764.75375, 1795.15648, 1825.37925,
                    1855.43268, 1885.326, 1915.06728, 1944.6636, 1974.1212, 2003.44559, 2032.64165, 2061.7137,
                    2090.6656, 2119.50078, 2148.22231, 2176.83293, 2205.33511, 2233.73104, 2262.0227, 2290.21187,
                    2318.30016, 2346.28899],
            31.62: [-7.7482295, 35.4568508, 78.3317138, 120.899547, 163.182357, 205.201148, 246.97611, 288.526798,
                    329.872335, 371.031617, 412.023551, 452.867316, 493.582664, 534.190274, 574.712174, 615.172265,
                    655.596983, 696.016154, 736.464152, 776.98147, 817.616964, 858.43114, 899.501165, 940.928878,
                    982.854337, 1025.48047, 1069.12241, 1114.32064, 1162.15964, 1215.57636, 1481.89213, 1552.57593,
                    1602.34335, 1645.68778, 1685.63612, 1723.41657, 1759.66495, 1794.75838, 1828.94107, 1862.38131,
                    1895.2005, 1927.48944, 1959.31793, 1990.74092, 2021.80248, 2052.53852, 2082.97871, 2113.14784,
                    2143.06683, 2172.75353],
            100.00: [-23.8277542, 18.9563545, 61.3834001, 103.47426, 145.248339, 186.723717, 227.917272, 268.844809,
                     309.521169, 349.960345, 390.175586, 430.179491, 469.98411, 509.601031, 549.041467, 588.316335,
                     627.436334, 666.412023, 705.253894, 743.972441, 782.578235, 821.081995, 859.494651, 897.82741,
                     936.091816, 974.299789, 1012.46366, 1050.59617, 1088.71044, 1126.81984, 1164.93787, 1203.07784,
                     1241.25246, 1279.4732, 1317.74952, 1356.08779, 1394.48998, 1432.95227, 1471.4636, 1510.00447,
                     1548.54631, 1587.05166, 1625.47537, 1663.76668, 1701.87194, 1739.73746, 1777.31203, 1814.54899,
                     1851.40763, 1887.85418]
        },
        "Density": {
            "T": [298, 303.6122449, 309.2244898, 314.8367347, 320.4489796, 326.0612245, 331.6734694, 337.2857143,
                  342.8979592, 348.5102041, 354.122449, 359.7346939, 365.3469388, 370.9591837, 376.571429, 382.183673,
                  387.795918, 393.408163, 399.020408, 404.632653, 410.244898, 415.857143, 421.469388, 427.081633,
                  432.693878, 438.306122, 443.918367, 449.530612, 455.142857, 460.755102, 466.367347, 471.979592,
                  477.591837, 483.204082, 488.816327, 494.428571, 500.040816, 505.653061, 511.265306, 516.877551,
                  522.489796, 528.102041, 533.714286, 539.326531, 544.938776, 550.55102, 556.163265, 561.77551,
                  567.387755, 573],
            1.00: [621.37161, 615.709035, 2.93366299, 2.8732754, 2.81569011, 2.76068837, 2.708076, 2.65767995,
                   2.60934531, 2.56293283, 2.51831681, 2.47538329, 2.43402861, 2.39415812, 2.35568518, 2.31853028,
                   2.28262026, 2.24788772, 2.21427038, 2.18171064, 2.15015511, 2.11955424, 2.08986192, 2.06103523,
                   2.0330341, 2.0058211, 1.97936121, 1.95362159, 1.92857143, 1.90418177, 1.88042537, 1.85727655,
                   1.8347111, 1.81270615, 1.79124009, 1.77029247, 1.74984391, 1.72987603, 1.71037141, 1.69131349,
                   1.67268652, 1.65447554, 1.63666628, 1.61924516, 1.60219923, 1.58551612, 1.56918403, 1.55319169,
                   1.53752831, 1.52218358],
            3.16: [621.657098, 616.010523, 610.284056, 604.470406, 598.561514, 592.548418, 586.421085, 580.168203,
                   573.776929, 8.71584745, 8.52387916, 8.34279065, 8.17149283, 8.00905126, 7.85465778, 7.70760868,
                   7.5672876, 7.43315188, 7.30472145, 7.18156986, 7.06331673, 6.94962144, 6.84017792, 6.73471014,
                   6.63296831, 6.53472569, 6.4397758, 6.34793007, 6.25901579, 6.17287438, 6.08935984, 6.00833744,
                   5.92968258, 5.85327978, 5.77902177, 5.70680877, 5.63654774, 5.5681518, 5.50153971, 5.43663533,
                   5.37336726, 5.3116684, 5.25147563, 5.19272947, 5.13537384, 5.07935578, 5.02462521, 4.97113475,
                   4.91883951, 4.8676969],
            10.00: [622.551338, 616.954258, 611.281522, 605.526377, 599.681402, 593.738388, 587.688208, 581.520642,
                    575.224174, 568.785727, 562.19032, 555.420636, 548.456428, 541.273739, 533.84382, 526.131616,
                    518.093593, 509.674511, 27.7669933, 26.9163135, 26.1482262, 25.4481859, 24.8052145, 24.2108168,
                    23.6582806, 23.1422082, 22.658193, 22.2025897, 21.7723475, 21.3648873, 20.9780083, 20.6098175,
                    20.2586742, 19.9231469, 19.6019793, 19.2940624, 18.9984121, 18.7141514, 18.440495, 18.1767369,
                    17.9222403, 17.6764283, 17.4387771, 17.2088091, 16.9860879, 16.7702138, 16.5608192, 16.3575659,
                    16.1601414, 15.9682569],
            31.62: [625.297998, 619.847331, 614.332842, 608.749182, 603.090562, 597.350692, 591.522704, 585.599061,
                    579.571453, 573.430666, 567.16642, 560.767165, 554.219828, 547.509485, 540.618939, 533.528173,
                    526.213624, 518.647218, 510.79504, 502.615485, 494.056602, 485.052164, 475.515633, 465.330463,
                    454.333602, 442.285354, 428.808765, 413.250154, 394.284684, 368.292535, 136.423205, 112.47386,
                    101.633712, 94.4241347, 89.0051002, 84.6643977, 81.0472054, 77.9499867, 75.2447859, 72.8457788,
                    70.6925453, 68.7409191, 66.9576276, 65.3169783, 63.7987187, 62.3866022, 61.0673985, 59.8301917,
                    58.6658715, 57.5667567],
            100.00: [633.286318, 628.218878, 623.11403, 617.968982, 612.780839, 607.546596, 602.263124, 596.927162,
                     591.535302, 586.08398, 580.569453, 574.987784, 569.334818, 563.606152, 557.797108, 551.902695,
                     545.917567, 539.835985, 533.651765, 527.358228, 520.948148, 514.413694, 507.746377, 500.936991,
                     493.975568, 486.851341, 479.552726, 472.067336, 464.382043, 456.483119, 448.35647, 439.988023,
                     431.364306, 422.473275, 413.305455, 403.855421, 394.123625, 384.118473, 373.858462, 363.374025,
                     352.708614, 341.918574, 331.071473, 320.242922, 309.512289, 298.958028, 288.65334, 278.662719,
                     269.039625, 259.825255]
        }
    }
}

MyProperties = deepcopy(AspenProperties)

water = Fluid(["water", 1])
butane = Fluid(["nButane", 1])
pentane = Fluid(["nPentane", 1])

colors = ["#1f77b4", "#ff7f0e", "#2ca02c", "#d62728", "#9467bd","#8c564b", "#e377c2"]
# colors = {"steelblue":"#1f77b4", "orange":"#ff7f0e", "green":"#2ca02c", "red":"#d62728", 60: "#9467bd",31: "#8c564b", 20: "#e377c2"}

def calc_properties(fluid_name):

    if fluid_name == "WATER":
        fluid = water
    elif fluid_name == "BUTANE":
        fluid = butane
    else:
        fluid = pentane

    APROPS = AspenProperties[fluid_name]
    MPROPS = MyProperties[fluid_name]

    ts = APROPS["Enthalpy"]["T"]
    ps = [i for i in APROPS["Enthalpy"]]
    ps =ps[1:]

    fig, axs = plt.subplots(3)

    axs[2].plot([np.NAN, np.NAN], [np.NAN, np.NAN], "ko", label="AspenPlus")
    axs[2].plot([np.NAN, np.NAN], [np.NAN, np.NAN], "k", label="PowerCycle")

    for i, p in enumerate(ps):
        label = "\\qty{"+"{:.2f}".format(p)+"}{\\bar}"
        axs[2].plot([np.NAN, np.NAN], [np.NAN, np.NAN], color=colors[i], label=label)

    for i, p in enumerate(ps):
        for j, t in enumerate(ts):
            fluid.update("PT", p*1e5, t)
            MPROPS["Enthalpy"][p][j] = fluid.properties.H*1.0
            MPROPS["Entropy"][p][j] = fluid.properties.S*1.0
            MPROPS["Density"][p][j] = fluid.properties.D*1.0

        axs[0].plot(ts, APROPS["Enthalpy"][p], "o", color=colors[i])
        axs[1].plot(ts, APROPS["Entropy"][p], "o", color=colors[i])
        axs[2].plot(ts, APROPS["Density"][p], "o", color=colors[i])

        axs[0].plot(ts, MPROPS["Enthalpy"][p], color=colors[i])
        axs[1].plot(ts, MPROPS["Entropy"][p], color=colors[i])
        axs[2].plot(ts, MPROPS["Density"][p], color=colors[i])

    axs[0].set_xlabel("Temperature/K")
    axs[0].set_ylabel("Enthalpy/J/kg")

    axs[1].set_xlabel("Temperature/K")
    axs[1].set_ylabel("Entropy/J/kg")

    axs[2].set_xlabel("Temperature/K")
    axs[2].set_ylabel("Density/kg/m3")
    axs[2].legend()

    tikzplotlib.save(fluid_name+".tex")

calc_properties("WATER")
calc_properties("BUTANE")
calc_properties("PENTANE")

plt.show()