import numpy as np
import matplotlib.pyplot as plt
import tikzplotlib
from cycler import cycler

ts=[100,110,120,130,140,150,160,170,180,190,200]
s_NaCl=[0,0.1,0.2,0.3]
qs_NaCl=[[0,0,0,0,0,0,0,0,0,0,0],[-1.15643142454589,-1.12101293316309,-1.0785727800762,-1.02877803059441,-0.97114586941317,-0.905013510669539,-0.829507669997931,-0.743499179094675,-0.645549510780064,-0.53383677112917,-0.406060889160786],[-0.498530369472294,-0.417538739330847,-0.319831353124334,-0.204661458596656,-0.0709244192296676,0.0829081186268121,0.258867089470671,0.459585993949019,0.688431060417716,0.949673458609124,1.24871542456848],[0.766029237295895,0.907206137326422,1.07432666748657,1.26874711224931,1.49238538931435,1.74783270195655,2.0384854742781,2.3687124247,2.74406970507353,3.17158207423769,3.66011696518354]]
s_NCG=[0.025,0.05,0.075]
qs_NCG=[[0,0,0,0,0,0,0,0,0,0,0],[0.334917798829082,0.414624722820633,0.492419823541601,0.567927608013052,0.642084636075668,0.711786888647059,0.776429515430443,0.837170004033716,0.892299335556879,0.947566168466629,0.994084695774733],[0.641500053668009,0.800148585333682,0.95280232810584,1.10601042046981,1.24987755924573,1.38843086822893,1.51879132729662,1.64026538799675,1.75564487267748,1.85875202501793,1.94965593792722],[0.946972911413679,1.18424392033392,1.41644552150046,1.63932683056198,1.85603202720328,2.06261090261397,2.25676298270778,2.43702981631009,2.60717831888078,2.75868296786039,2.89124087095927]]

c = plt.get_cmap('tab20c').colors
plt.rcParams['axes.prop_cycle'] = cycler(color=c)

fig, ax = plt.subplots()

offset = 4
qs_NCG.reverse()
s_NCG.reverse()

ax.plot(ts, [-0.5 for t in ts], color=c[offset], label="NCG content/\\unit{\\kg\\per\\kg}")
for i, ps in enumerate(qs_NCG):
    if i != 3:
        ax.plot(ts, ps, color= c[offset+i], label="\\quad{:.3f}".format(s_NCG[i]))
    # else:
    #

ax.plot(ts, qs_NCG[-1], label="Pure Water")

offset = 12
for i, ps in enumerate(qs_NaCl):
    if i != 0:
        ax.plot(ts, ps, color= c[offset-i-1], label="\\quad{:.1f}".format(s_NaCl[i]))
    else:
        ax.plot(ts, [-0.5 for t in ts], color=c[offset-4], label="Salinity/\\unit{\\kg\\per\\kg}")


ax.set_xlabel("Temperature/\\unit{\\degreeCelsius}")
ax.set_ylabel("Delta Heat Flow/\\unit{\\percent}")
# ax.set_ylim((0, None))

ax.legend()


tikzplotlib.save("DeltaQ.tex")

plt.show()