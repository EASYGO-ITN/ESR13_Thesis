import matplotlib.pyplot as plt
from matplotlib import cm
import matplotlib

import tikzplotlib

matplotlib.use("pgf")

matplotlib.rcParams.update({
    "pgf.texsystem": "pdflatex",
       "figure.figsize" : (4.9, 3.5),
    'font.family': 'serif',
       "font.size":    12.0,
    'text.usetex': True,
       "text.latex.preamble": "\\usepackage{amsmath}\\usepackage{amssymb}\\usepackage{siunitx}",
    'pgf.rcfonts': False,
})

NaCl=[0,0.02,0.04,0.06,0.08,0.1,0.12,0.14,0.16,0.18,0.2]
NCG=[0,0.003,0.006,0.009,0.012,0.015,0.018,0.021,0.024,0.027,0.03]
pws=[[132.711179,128.465446,124.193662,119.90836,115.609411,114.631033,115.056365,115.483483,115.91014,116.33709,116.764336],[132.211504,127.985764,123.732453,119.465532,115.233615,114.727595,115.155597,115.583054,116.008726,116.373392,116.865998],[131.852142,127.646479,123.413288,119.166411,114.90575,114.933022,115.362077,115.799998,116.229014,116.658335,117.027079],[131.482084,127.297834,123.086202,118.860793,114.794404,115.223077,115.652934,116.082371,116.512155,116.942216,117.389809],[131.055046,126.893564,122.704451,118.501685,115.144051,115.573963,116.006015,116.436892,116.868067,117.299536,117.731331],[130.626658,126.489515,122.324686,118.14594,115.54231,115.975215,116.406821,116.840651,117.27333,117.706302,118.139566],[130.183644,126.070682,121.931261,117.77778,115.981755,116.414466,116.848933,117.282931,117.71737,118.15207,118.09617],[129.767127,125.680047,121.567402,117.440444,116.449738,116.853926,117.322439,117.756661,118.192859,118.629401,119.067251],[129.250068,125.189441,121.104245,117.005445,116.944694,117.382007,117.819765,118.257248,118.695025,119.132324,119.570836],[128.80859,124.776863,120.71954,117.022041,117.460767,117.898759,118.338153,118.777287,119.216697,119.607786,120.0969],[128.315706,124.311263,120.28277,117.550976,117.991517,118.431234,118.872309,119.313141,119.754256,120.195653,120.637332]]

boundary_NCG=[0.0135,0.0135,0.0135,0.0135,0.0135,0.0105,0.0105,0.0105,0.0105,0.0105,0.0105,0.0105,0.0105,0.0105,0.0105,0.0105,0.0105,0.0075,0.0075,0.0075,0.0075]
boundary_NaCl=[0,0,0.02,0.02,0.04,0.04,0.06,0.06,0.08,0.08,0.1,0.1,0.12,0.12,0.14,0.14,0.16,0.16,0.18,0.18,0.2]

fig, ax = plt.subplots()

cs = ax.contourf(NCG, NaCl, pws, cmap=cm.Oranges)
# fig.colorbar(cs, label="Specific net power/\\unit{\\kilo\\watt\\s\\per\\kg}")
fig.colorbar(cs, label="Specific net power/kW s kg-1")

ax.plot(boundary_NCG, boundary_NaCl, color="grey")
# ax.set_ylim((100, 200))

# ax.set_xlabel("Steam Quality/\\unit{\\percent}")
# ax.set_ylabel("Inlet Temperature/\\unit{\\degreeCelsius}")
#
ax.set_xlabel("NCG Content/kg/kg")
ax.set_ylabel("Salinity/kg/kg")

ax.annotate("ORC", (0.022, 0.15))
ax.annotate("DSC", (0.005, 0.08))

plt.tight_layout()

plt.savefig('PureWater_SalNCG_map.pgf')

# plt.show()